<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DealFlow - Amazon Deal Tracker</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    // Icons as simple emoji/text (replacing lucide-react)
    const Icons = {
      Heart: ({size, fill, color}) => <span style={{fontSize: size || 20, color: color || 'currentColor'}}>{fill ? '‚ù§Ô∏è' : 'ü§ç'}</span>,
      Star: ({size, fill, color}) => <span style={{fontSize: size || 14, color: color || 'currentColor'}}>‚≠ê</span>,
      Crown: ({size}) => <span style={{fontSize: size || 16}}>üëë</span>,
      Bell: ({size}) => <span style={{fontSize: size || 20}}>üîî</span>,
      Search: ({size}) => <span style={{fontSize: size || 20}}>üîç</span>,
      X: ({size}) => <span style={{fontSize: size || 16}}>‚úï</span>,
      ExternalLink: ({size}) => <span style={{fontSize: size || 16}}>üîó</span>,
      Sparkles: ({size}) => <span style={{fontSize: size || 16}}>‚ú®</span>
    };

    function DealFlow() {
      const [user, setUser] = useState(null);
      const [deals, setDeals] = useState([]);
      const [savedDeals, setSavedDeals] = useState([]);
      const [notifications, setNotifications] = useState([]);
      const [selectedCategory, setSelectedCategory] = useState('All');
      const [searchTerm, setSearchTerm] = useState('');
      const [country, setCountry] = useState('US');
      const [showNotifications, setShowNotifications] = useState(false);
      const [showWelcome, setShowWelcome] = useState(false);
      const [showPriceHistory, setShowPriceHistory] = useState(null);

      const categories = ['All', 'Electronics', 'Home', 'Gaming'];
      const countries = [
        { code: 'US', name: 'United States', domain: 'amazon.com', flag: 'üá∫üá∏' },
        { code: 'AU', name: 'Australia', domain: 'amazon.com.au', flag: 'üá¶üá∫' },
        { code: 'UK', name: 'United Kingdom', domain: 'amazon.co.uk', flag: 'üá¨üáß' },
        { code: 'DE', name: 'Germany', domain: 'amazon.de', flag: 'üá©üá™' }
      ];

      const YOUR_AFFILIATE_TAG = 'dealflow-22';

      const storage = {
        get: async (key) => {
          const val = localStorage.getItem(key);
          return val ? { value: val } : null;
        },
        set: async (key, value) => {
          localStorage.setItem(key, value);
          return { key, value };
        }
      };

      useEffect(() => {
        initApp();
      }, [country]);

      const getAmazonUrl = (asin) => {
        const domain = countries.find(c => c.code === country)?.domain || 'amazon.com';
        return \`https://www.\${domain}/dp/\${asin}?tag=\${YOUR_AFFILIATE_TAG}\`;
      };

      const initApp = async () => {
        const realDeals = [
          {
            id: 1,
            title: 'Apple AirPods (2nd Generation)',
            asin: 'B07PXGQC1Q',
            category: 'Electronics',
            original: 129.00,
            price: 89.99,
            lowestEver: 79.99,
            image: 'https://m.media-amazon.com/images/I/61CVih3UpdL._AC_SL1000_.jpg',
            rating: 4.7,
            reviews: 607845,
            trending: true,
            priceHistory: [129, 119, 109, 99, 94, 89.99]
          },
          {
            id: 2,
            title: 'Fire TV Stick 4K',
            asin: 'B0CX74S6SH',
            category: 'Electronics',
            original: 49.99,
            price: 27.99,
            lowestEver: 24.99,
            image: 'https://m.media-amazon.com/images/I/51TjJOTfslL._AC_SL1000_.jpg',
            rating: 4.6,
            reviews: 521890,
            trending: true,
            priceHistory: [49.99, 44.99, 39.99, 34.99, 29.99, 27.99]
          },
          {
            id: 3,
            title: 'Echo Dot (5th Gen)',
            asin: 'B09B8V1LZ3',
            category: 'Electronics',
            original: 49.99,
            price: 22.99,
            lowestEver: 22.99,
            image: 'https://m.media-amazon.com/images/I/71h6ykEg+dL._AC_SL1000_.jpg',
            rating: 4.7,
            reviews: 412567,
            trending: true,
            priceHistory: [49.99, 44.99, 39.99, 29.99, 24.99, 22.99]
          },
          {
            id: 4,
            title: 'Instant Pot Duo 7-in-1',
            asin: 'B00FLYWNYQ',
            category: 'Home',
            original: 99.99,
            price: 49.99,
            lowestEver: 49.99,
            image: 'https://m.media-amazon.com/images/I/71Xp17D7WHL._AC_SL1500_.jpg',
            rating: 4.7,
            reviews: 123456,
            trending: false,
            priceHistory: [99.99, 89.99, 79.99, 69.99, 59.99, 49.99]
          },
          {
            id: 5,
            title: 'Ninja Air Fryer',
            asin: 'B089TQ82WT',
            category: 'Home',
            original: 189.99,
            price: 99.99,
            lowestEver: 99.99,
            image: 'https://m.media-amazon.com/images/I/81SVCC8bSPL._AC_SL1500_.jpg',
            rating: 4.8,
            reviews: 34892,
            trending: true,
            priceHistory: [189.99, 169.99, 149.99, 129.99, 119.99, 99.99]
          },
          {
            id: 6,
            title: 'PlayStation DualSense',
            asin: 'B0CQKLS4RP',
            category: 'Gaming',
            original: 74.99,
            price: 54.99,
            lowestEver: 48.99,
            image: 'https://m.media-amazon.com/images/I/61ea26ihAgL._AC_SL1500_.jpg',
            rating: 4.6,
            reviews: 81253,
            trending: true,
            priceHistory: [74.99, 69.99, 64.99, 59.99, 56.99, 54.99]
          }
        ];
        
        setDeals(realDeals);

        try {
          const userData = await storage.get('dealflow_user');
          if (userData) {
            const u = JSON.parse(userData.value);
            setUser(u);
            
            const saved = await storage.get(\`saved_\${u.id}\`);
            if (saved) setSavedDeals(JSON.parse(saved.value));
            
            const notifs = await storage.get(\`notif_\${u.id}\`);
            if (notifs) setNotifications(JSON.parse(notifs.value));
          }
        } catch (e) {}
      };

      const handleSignup = async (email) => {
        const newUser = {
          id: Date.now(),
          email,
          isPremium: false,
          totalSaved: 0
        };

        await storage.set('dealflow_user', JSON.stringify(newUser));
        await storage.set(\`saved_\${newUser.id}\`, JSON.stringify([]));
        await storage.set(\`notif_\${newUser.id}\`, JSON.stringify([]));
        
        setUser(newUser);
        setShowWelcome(true);
      };

      const saveDeal = async (deal) => {
        if (!user) {
          alert('Sign up to track deals!');
          return;
        }

        const isSaved = savedDeals.some(d => d.id === deal.id);
        let newSaved;
        let updatedUser = { ...user };
        
        if (isSaved) {
          newSaved = savedDeals.filter(d => d.id !== deal.id);
          const savings = deal.original - deal.price;
          updatedUser.totalSaved = Math.max(0, user.totalSaved - savings);
        } else {
          newSaved = [...savedDeals, deal];
          const savings = deal.original - deal.price;
          updatedUser.totalSaved = user.totalSaved + savings;
        }
        
        setUser(updatedUser);
        setSavedDeals(newSaved);
        await storage.set('dealflow_user', JSON.stringify(updatedUser));
        await storage.set(\`saved_\${user.id}\`, JSON.stringify(newSaved));
      };

      const filtered = deals.filter(d => {
        const catMatch = selectedCategory === 'All' || d.category === selectedCategory;
        const searchMatch = d.title.toLowerCase().includes(searchTerm.toLowerCase());
        return catMatch && searchMatch;
      });

      if (!user) {
        return (
          <div style={{minHeight:'100vh',background:'linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 50%, #16213e 100%)',color:'#fff'}}>
            <div style={{maxWidth:'1200px',margin:'0 auto',padding:'40px 20px'}}>
              <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'60px'}}>
                <div style={{display:'flex',alignItems:'center',gap:'12px'}}>
                  <div style={{width:'40px',height:'40px',background:'linear-gradient(135deg, #a855f7, #ec4899)',borderRadius:'10px',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:'800',fontSize:'20px'}}>D</div>
                  <span style={{fontSize:'24px',fontWeight:'700'}}>DealFlow</span>
                </div>
                <select value={country} onChange={(e)=>setCountry(e.target.value)} style={{padding:'8px 16px',background:'rgba(255,255,255,0.1)',border:'1px solid rgba(255,255,255,0.2)',borderRadius:'8px',color:'#fff',fontSize:'14px'}}>
                  {countries.map(c=><option key={c.code} value={c.code} style={{background:'#1a1a2e'}}>{c.flag} {c.name}</option>)}
                </select>
              </div>

              <div style={{textAlign:'center',marginBottom:'60px'}}>
                <h1 style={{fontSize:'64px',fontWeight:'800',lineHeight:'1.1',marginBottom:'24px',background:'linear-gradient(135deg, #fff 0%, #a855f7 100%)',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'}}>
                  Real Amazon Deals.<br/>Real Savings.
                </h1>
                <p style={{fontSize:'20px',color:'rgba(255,255,255,0.7)',maxWidth:'700px',margin:'0 auto 40px'}}>
                  Track prices across {countries.length} countries. Your affiliate tag: <strong>{YOUR_AFFILIATE_TAG}</strong>
                </p>

                <div style={{display:'flex',gap:'12px',maxWidth:'500px',margin:'0 auto'}}>
                  <input id="emailInput" type="email" placeholder="Enter your email" style={{flex:1,padding:'16px 20px',background:'rgba(255,255,255,0.05)',border:'1px solid rgba(255,255,255,0.2)',borderRadius:'10px',color:'#fff',fontSize:'16px',outline:'none'}}/>
                  <button onClick={()=>{const email=document.getElementById('emailInput').value;if(email?.includes('@'))handleSignup(email);else alert('Enter valid email')}} style={{padding:'16px 32px',background:'linear-gradient(135deg, #a855f7, #ec4899)',border:'none',borderRadius:'10px',color:'#fff',fontWeight:'700',fontSize:'16px',cursor:'pointer'}}>
                    Start Free
                  </button>
                </div>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div style={{minHeight:'100vh',background:'#0a0a0f',color:'#fff'}}>
          <div style={{background:'rgba(255,255,255,0.03)',borderBottom:'1px solid rgba(255,255,255,0.1)',padding:'16px 24px'}}>
            <div style={{maxWidth:'1400px',margin:'0 auto',display:'flex',justifyContent:'space-between',alignItems:'center'}}>
              <div style={{display:'flex',alignItems:'center',gap:'12px'}}>
                <div style={{width:'36px',height:'36px',background:'linear-gradient(135deg, #a855f7, #ec4899)',borderRadius:'8px',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:'800'}}>D</div>
                <span style={{fontSize:'20px',fontWeight:'700'}}>DealFlow</span>
              </div>
              <select value={country} onChange={(e)=>setCountry(e.target.value)} style={{padding:'6px 12px',background:'rgba(255,255,255,0.1)',border:'1px solid rgba(255,255,255,0.2)',borderRadius:'8px',color:'#fff',fontSize:'14px'}}>
                {countries.map(c=><option key={c.code} value={c.code} style={{background:'#1a1a2e'}}>{c.flag} {c.code}</option>)}
              </select>
            </div>
          </div>

          <div style={{maxWidth:'1400px',margin:'0 auto',padding:'32px 24px'}}>
            <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px',marginBottom:'32px'}}>
              <div style={{padding:'24px',background:'rgba(168,85,247,0.1)',border:'1px solid rgba(168,85,247,0.2)',borderRadius:'12px'}}>
                <div style={{fontSize:'32px',fontWeight:'800',color:'#a855f7',marginBottom:'8px'}}>\${user.totalSaved.toFixed(0)}</div>
                <div style={{fontSize:'14px',color:'#999'}}>Total Savings</div>
              </div>
              <div style={{padding:'24px',background:'rgba(236,72,153,0.1)',border:'1px solid rgba(236,72,153,0.2)',borderRadius:'12px'}}>
                <div style={{fontSize:'32px',fontWeight:'800',color:'#ec4899',marginBottom:'8px'}}>{savedDeals.length}</div>
                <div style={{fontSize:'14px',color:'#999'}}>Deals Saved</div>
              </div>
            </div>

            <div style={{background:'rgba(255,255,255,0.03)',padding:'20px',borderRadius:'12px',marginBottom:'24px',border:'1px solid rgba(255,255,255,0.1)'}}>
              <input type="text" placeholder="Search products..." value={searchTerm} onChange={(e)=>setSearchTerm(e.target.value)} style={{width:'100%',padding:'12px',background:'rgba(255,255,255,0.05)',border:'1px solid rgba(255,255,255,0.1)',borderRadius:'8px',color:'#fff',fontSize:'15px',outline:'none',marginBottom:'16px'}}/>
              <div style={{display:'flex',gap:'8px',flexWrap:'wrap'}}>
                {categories.map(cat=><button key={cat} onClick={()=>setSelectedCategory(cat)} style={{padding:'8px 16px',background:selectedCategory===cat?'linear-gradient(135deg, #a855f7, #ec4899)':'rgba(255,255,255,0.05)',border:selectedCategory===cat?'none':'1px solid rgba(255,255,255,0.1)',borderRadius:'20px',color:'#fff',cursor:'pointer',fontSize:'14px',fontWeight:selectedCategory===cat?'700':'400'}}>{cat}</button>)}
              </div>
            </div>

            <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(340px, 1fr))',gap:'20px'}}>
              {filtered.map(deal=>{
                const isSaved=savedDeals.some(d=>d.id===deal.id);
                const discount=Math.round(((deal.original-deal.price)/deal.original)*100);
                return(
                  <div key={deal.id} style={{background:'rgba(255,255,255,0.04)',border:'1px solid rgba(255,255,255,0.08)',borderRadius:'12px',padding:'20px'}}>
                    <div style={{width:'100%',height:'200px',background:'#fff',borderRadius:'10px',marginBottom:'16px',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden'}}>
                      <img src={deal.image} alt={deal.title} style={{maxWidth:'100%',maxHeight:'100%',objectFit:'contain'}}/>
                    </div>
                    {deal.trending&&<div style={{padding:'4px 8px',background:'rgba(239,68,68,0.2)',borderRadius:'6px',fontSize:'11px',fontWeight:'700',color:'#ef4444',display:'inline-block',marginBottom:'12px'}}>üî• HOT</div>}
                    <h3 style={{fontSize:'16px',fontWeight:'700',marginBottom:'8px',lineHeight:'1.3',minHeight:'40px'}}>{deal.title}</h3>
                    <div style={{fontSize:'11px',color:'#666',marginBottom:'12px'}}>ASIN: {deal.asin}</div>
                    <div style={{display:'flex',alignItems:'baseline',gap:'10px',marginBottom:'16px'}}>
                      <span style={{fontSize:'28px',fontWeight:'800',color:'#a855f7'}}>\${deal.price}</span>
                      <span style={{fontSize:'16px',color:'#666',textDecoration:'line-through'}}>\${deal.original}</span>
                      <span style={{padding:'4px 8px',background:'#10b981',borderRadius:'6px',fontSize:'12px',fontWeight:'700'}}>-{discount}%</span>
                    </div>
                    <div style={{marginBottom:'16px',fontSize:'13px',color:'#999'}}>‚≠ê {deal.rating} ({(deal.reviews/1000).toFixed(0)}K)</div>
                    <div style={{display:'flex',gap:'8px'}}>
                      <button onClick={()=>window.open(getAmazonUrl(deal.asin),'_blank')} style={{flex:1,padding:'12px',background:'linear-gradient(135deg, #a855f7, #ec4899)',border:'none',borderRadius:'8px',color:'#fff',fontWeight:'700',cursor:'pointer'}}>üîó Buy Now</button>
                      <button onClick={()=>saveDeal(deal)} style={{padding:'12px',background:isSaved?'rgba(239,68,68,0.2)':'rgba(255,255,255,0.08)',border:isSaved?'1px solid rgba(239,68,68,0.4)':'1px solid rgba(255,255,255,0.1)',borderRadius:'8px',cursor:'pointer'}}>{isSaved?'‚ù§Ô∏è':'ü§ç'}</button>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<DealFlow />);
  </script>
</body>
</html>
